"use strict";(self.webpackChunkdongdong_12138_github_io=self.webpackChunkdongdong_12138_github_io||[]).push([[1884],{8992:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>s,default:()=>f,frontMatter:()=>t,metadata:()=>l,toc:()=>i});var o=r(5893),a=r(1151);const t={sidebar_position:6},s="toRef\u3001toRaw\u3001readonly",l={id:"front-frame/Vue3/toRef\u3001toRaw\u3001readyonly",title:"toRef\u3001toRaw\u3001readonly",description:"toRefs\u3001toRef",source:"@site/docs/front-frame/Vue3/06-toRef\u3001toRaw\u3001readyonly.md",sourceDirName:"front-frame/Vue3",slug:"/front-frame/Vue3/toRef\u3001toRaw\u3001readyonly",permalink:"/docs/front-frame/Vue3/toRef\u3001toRaw\u3001readyonly",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/front-frame/Vue3/06-toRef\u3001toRaw\u3001readyonly.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"front-frame",previous:{title:"computed \u4e0e watch",permalink:"/docs/front-frame/Vue3/computed\u4e0ewatch"},next:{title:"\u751f\u547d\u5468\u671f",permalink:"/docs/front-frame/Vue3/\u751f\u547d\u5468\u671f"}},c={},i=[{value:"toRefs\u3001toRef",id:"torefstoref",level:2},{value:"toRef \u6ce8\u610f\u4e8b\u9879",id:"toref-\u6ce8\u610f\u4e8b\u9879",level:2},{value:"toRaw\u3001markRaw",id:"torawmarkraw",level:2},{value:"readonly \u4e0e shallowReadonly",id:"readonly-\u4e0e-shallowreadonly",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{id:"toreftorawreadonly",children:"toRef\u3001toRaw\u3001readonly"}),"\n",(0,o.jsx)(n.h2,{id:"torefstoref",children:"toRefs\u3001toRef"}),"\n",(0,o.jsxs)(n.p,{children:["\u4f5c\u7528\uff1a\u5c06\u4e00\u4e2a\u54cd\u5e94\u5f0f\u5bf9\u8c61\u4e2d\u7684\u5c5e\u6027\uff0c\u8f6c\u6362\u4e3a ",(0,o.jsx)(n.code,{children:"ref"})," \u5bf9\u8c61\u3002"]}),"\n",(0,o.jsxs)(n.p,{children:["\u5907\u6ce8\uff1a",(0,o.jsx)(n.code,{children:"toRefs"})," \u4e0e ",(0,o.jsx)(n.code,{children:"toRef"})," \u529f\u80fd\u4e00\u81f4\uff0c\u4f46 ",(0,o.jsx)(n.code,{children:"toRefs"})," \u53ef\u4ee5\u6279\u91cf\u8f6c\u6362\u3002"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"import { reactive, toRefs, toRef } from 'vue'\r\n\r\nlet person = reactive({ name: '\u5f20\u4e09', age: 18, gender: '\u7537' })\r\n\r\n// \u901a\u8fc7\u89e3\u6784\u8d4b\u503c\u7684\u65b9\u5f0f\u83b7\u53d6\u5230\u7684 name \u548c age\uff0c\u662f\u4e0d\u5177\u6709\u54cd\u5e94\u5f0f\u7684\r\n// \u8fd9\u76f8\u5f53\u4e8e\uff1alet name = person.name; let age = person.age\r\n// \u6240\u4ee5 name \u548c age \u76f8\u5f53\u4e8e\u662f\u58f0\u660e\u7684\u4e00\u4e2a\u65b0\u7684\u53d8\u91cf\uff0c\u56e0\u6b64\u4e0d\u5177\u6709\u54cd\u5e94\u5f0f\uff0c\u4fee\u6539 name \u548c age \u4e5f\u65e0\u6cd5\u89e6\u53d1\u9875\u9762\u66f4\u65b0\r\n// let { name, age } = person\r\n\r\n// \u901a\u8fc7 toRefs \u5c06 person \u5bf9\u8c61\u4e2d\u7684 n \u4e2a\u5c5e\u6027\u6279\u91cf\u53d6\u51fa\uff0c\u4e14\u4f9d\u7136\u4fdd\u6301\u54cd\u5e94\u5f0f\u7684\u80fd\u529b\r\nlet { name, gender } = toRefs(person)\r\n\r\n// \u901a\u8fc7 toRef \u5c06 person \u5bf9\u8c61\u4e2d\u7684 age \u5c5e\u6027\u53d6\u51fa\uff0c\u4e14\u4f9d\u7136\u4fdd\u6301\u54cd\u5e94\u5f0f\u7684\u80fd\u529b\r\nlet age = toRef(person, 'age')\r\n\r\nfunction changeName() {\r\n  // \u4fee\u6539 name.value\uff0c\u4e5f\u4f1a\u4fee\u6539 person.name \u7684\u503c\r\n  name.value += '~'\r\n}\r\nfunction changeAge() {\r\n  // \u4fee\u6539 age.value\uff0c\u4e5f\u4f1a\u4fee\u6539 person.age \u7684\u503c\r\n  age.value += 1\r\n}\r\nfunction changeGender() {\r\n  // \u4fee\u6539 gender.value\uff0c\u4e5f\u4f1a\u4fee\u6539 person.gender \u7684\u503c\r\n  gender.value = '\u5973'\r\n}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"toref-\u6ce8\u610f\u4e8b\u9879",children:"toRef \u6ce8\u610f\u4e8b\u9879"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"import { reactive, toRef } from 'vue'\r\n\r\n// \u5982\u679c\u539f\u59cb\u5bf9\u8c61\u4e0d\u662f\u54cd\u5e94\u5f0f\u7684\uff0c\u53ef\u4ee5\u4fee\u6539\u6570\u636e\uff0c\u4f46\u4e0d\u4f1a\u66f4\u65b0\u89c6\u56fe\r\n// const obj = { a: 1, b: 2 }\r\n\r\n// \u5982\u679c\u539f\u59cb\u5bf9\u8c61\u662f\u54cd\u5e94\u5f0f\u7684\uff0c\u53ef\u4ee5\u4fee\u6539\u6570\u636e\uff0c\u5e76\u4e14\u4f1a\u66f4\u65b0\u89c6\u56fe\r\nconst obj = reactive({ a: 1, b: 2 })\r\n\r\nconst a = toRef(obj, 'a')\r\n\r\nconst handleAdd = () => {\r\n  a.value += 1\r\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u4e3a\u4ec0\u4e48\u539f\u59cb\u5bf9\u8c61\u4e0d\u662f\u54cd\u5e94\u5f0f\u7684\uff0c\u4f7f\u7528 ",(0,o.jsx)(n.code,{children:"toRef"})," \u8f6c\u5316\u6210 ref \u5bf9\u8c61\u540e\uff0c\u4ecd\u7136\u65e0\u6cd5\u66f4\u65b0\u89c6\u56fe\uff1f"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",metastring:'title="toRef \u6e90\u7801"',children:"export function toRef<T extends object, K extends keyof T>(\r\n  object: T,\r\n  key: K,\r\n  defaultValue?: T[K]\r\n): ToRef<T[K]> {\r\n  const val = object[key];\r\n  // 1. \u5982\u679c\u539f\u59cb\u5bf9\u8c61\u662f ref \u5bf9\u8c61\u5c31\u76f4\u63a5\u8fd4\u56de\uff0c\u5426\u5219\u8c03\u7528 ObjectRefImpl \u521b\u5efa\u4e00\u4e2a\u7c7b ref \u5bf9\u8c61\u5e76\u8fd4\u56de\r\n  return isRef(val) ? val : (new ObjectRefImpl(object, key, defaultValue) as any);\r\n}\r\n\r\nclass ObjectRefImpl<T extends object, K extends keyof T> {\r\n  public readonly __v_isRef = true;\r\n\r\n  constructor(\r\n    private readonly _object: T,\r\n    private readonly _key: K,\r\n    private readonly _defaultValue?: T[K]\r\n  ) {}\r\n\r\n  // 2. \u7c7b ref \u5bf9\u8c61\u53ea\u662f\u505a\u4e86\u503c\u7684\u6539\u53d8\uff0c\u5e76\u672a\u5904\u7406\u201c\u6536\u96c6\u4f9d\u8d56\u201d\u548c\u201c\u89e6\u53d1\u4f9d\u8d56\u201d\u7684\u8fc7\u7a0b\r\n  //    \u6240\u4ee5\u666e\u901a\u5bf9\u8c61\u65e0\u6cd5\u66f4\u65b0\u89c6\u56fe\r\n  get value() {\r\n    const val = this._object[this._key];\r\n    return val === undefined ? (this._defaultValue as T[K]) : val;\r\n  }\r\n\r\n  set value(newVal) {\r\n    this._object[this._key] = newVal;\r\n  }\r\n}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"torawmarkraw",children:"toRaw\u3001markRaw"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"toRaw"})," \u7528\u4e8e\u5c06\u54cd\u5e94\u5f0f\u5bf9\u8c61\u8f6c\u5316\u4e3a\u666e\u901a\u5bf9\u8c61\uff0c\u4f7f\u5176\u4e0d\u5177\u6709\u54cd\u5e94\u5f0f\uff0c\u4e0d\u89e6\u53d1\u9875\u9762\u7684\u66f4\u65b0\u3002"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\u4f55\u65f6\u4f7f\u7528\uff1a\u5728\u9700\u8981\u5c06\u54cd\u5e94\u5f0f\u5bf9\u8c61\u4f20\u9012\u7ed9 Vue \u4ee5\u5916\u7684\u5e93\u6216\u5916\u90e8\u7cfb\u7edf\u65f6\uff0c\u4f7f\u7528 ",(0,o.jsx)(n.code,{children:"toRaw"})," \u53ef\u4ee5\u786e\u4fdd\u5b83\u4eec\u6536\u5230\u7684\u662f\u666e\u901a\u5bf9\u8c61\u3002"]}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"markRaw"})," \u7528\u4e8e\u6807\u8bb0\u4e00\u4e2a\u5bf9\u8c61\uff0c\u4f7f\u5176",(0,o.jsx)(n.strong,{children:"\u6c38\u8fdc\u4e0d\u4f1a"}),"\u53d8\u6210\u54cd\u5e94\u5f0f\u7684\u3002"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\u4f8b\u5982\u4f7f\u7528 ",(0,o.jsx)(n.code,{children:"mockjs"})," \u65f6\uff0c\u4e3a\u4e86\u9632\u6b62\u8bef\u628a ",(0,o.jsx)(n.code,{children:"mockjs"})," \u53d8\u4e3a\u54cd\u5e94\u5f0f\u5bf9\u8c61\uff0c\u53ef\u4ee5\u4f7f\u7528 ",(0,o.jsx)(n.code,{children:"markRaw"})," \u53bb\u6807\u8bb0 ",(0,o.jsx)(n.code,{children:"mockjs"}),"\u3002"]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"import { reactive, toRaw, markRaw, isReactive } from 'vue'\r\n\r\n// \u54cd\u5e94\u5f0f\u5bf9\u8c61\r\nlet person = reactive({ name: 'tony', age: 18 })\r\n// \u539f\u59cb\u5bf9\u8c61\uff0c\u4e0d\u5177\u6709\u54cd\u5e94\u5f0f\r\nlet rawPerson = toRaw(person)\r\n\r\nlet citys = markRaw([\r\n  { id: 'asdda01', name: '\u5317\u4eac' }, { id: 'asdda02', name: '\u4e0a\u6d77' },\r\n  { id: 'asdda03', name: '\u5929\u6d25' }, { id: 'asdda04', name: '\u91cd\u5e86' }\r\n])\r\n// \u6839\u636e\u539f\u59cb\u5bf9\u8c61 citys \u53bb\u521b\u5efa\u54cd\u5e94\u5f0f\u5bf9\u8c61 citys2 \u2014\u2014 \u521b\u5efa\u5931\u8d25\uff0c\u56e0\u4e3a citys \u88ab markRaw \u6807\u8bb0\u4e86\r\nlet citys2 = reactive(citys)\r\n\r\nconsole.log(isReactive(person))     // true\r\nconsole.log(isReactive(rawPerson))  // false\r\nconsole.log(isReactive(citys))      // false\r\nconsole.log(isReactive(citys2))     // false\n"})}),"\n",(0,o.jsx)(n.h2,{id:"readonly-\u4e0e-shallowreadonly",children:"readonly \u4e0e shallowReadonly"}),"\n",(0,o.jsx)(n.p,{children:"\u4f5c\u7528\uff1a\u5bf9\u7279\u5b9a\u6570\u636e\u8fdb\u884c\u4fdd\u62a4\u3002"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"readonly"})," \u7528\u4e8e\u521b\u5efa\u4e00\u4e2a\u5bf9\u8c61\u7684\u6df1\u53ea\u8bfb\u526f\u672c\uff1b"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"shallowReadonly"})," \u4e0e ",(0,o.jsx)(n.code,{children:"readonly"})," \u7c7b\u4f3c\uff0c\u4f46\u53ea\u5c06\u5bf9\u8c61\u7684\u9876\u5c42\u5c5e\u6027\u8bbe\u7f6e\u4e3a\u53ea\u8bfb\uff0c\u5bf9\u8c61\u5185\u90e8\u7684\u5d4c\u5957\u5c5e\u6027\u4ecd\u7136\u662f\u53ef\u53d8\u7684\uff1b"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"readonly"})," \u4e0e ",(0,o.jsx)(n.code,{children:"shallowReadonly"})," \u53ef\u4ee5\u5bf9 ",(0,o.jsx)(n.code,{children:"ref"})," \u548c ",(0,o.jsx)(n.code,{children:"reactive"})," \u5b9a\u4e49\u7684\u54cd\u5e94\u5f0f\u6570\u636e\u8fdb\u884c\u5305\u88f9\u3002"]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-ts",children:"import { reactive, readonly } from 'vue';\r\n\r\nconst lisi = reactive({ name: '\u674e\u56db' });\r\nconst lisiCopy = readonly(lisi);\r\n\r\nconst changeLisi = () => {\r\n  lisi.name = '\u674e\u56db123';\r\n  // lisiCopy \u672c\u65e0\u6cd5\u4fee\u6539\uff0c\u56e0\u4e3a\u5b83\u662f\u53ea\u8bfb\u7684\r\n  // \u4f46\u8fd9\u4e2a\u65b9\u6cd5\u4e2d\u4e5f\u4fee\u6539\u4e86 lisi\uff0clisi \u662f\u54cd\u5e94\u5f0f\u7684\uff0c\u5bfc\u81f4 lisiCopy \u7684\u4fee\u6539\u4e5f\u4f1a\u4f53\u73b0\u5728\u89c6\u56fe\u4e0a\r\n  lisiCopy.name = '\u674e\u56db123';\r\n}\n"})})]})}function f(e={}){const{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},1151:(e,n,r)=>{r.d(n,{Z:()=>l,a:()=>s});var o=r(7294);const a={},t=o.createContext(a);function s(e){const n=o.useContext(t);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),o.createElement(t.Provider,{value:n},e.children)}}}]);