"use strict";(self.webpackChunkdongdong_12138_github_io=self.webpackChunkdongdong_12138_github_io||[]).push([[488],{2060:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>r,contentTitle:()=>d,default:()=>p,frontMatter:()=>l,metadata:()=>a,toc:()=>o});var i=s(5893),t=s(1151);const l={},d="\u5c0f\u7a0b\u5e8f-\u4e91\u97f3\u4e50",a={id:"projects/miniprogram-music",title:"\u5c0f\u7a0b\u5e8f-\u4e91\u97f3\u4e50",description:"\u5c0f\u7a0b\u5e8f\u4e2d\u4f7f\u7528 iconfont",source:"@site/docs/projects/miniprogram-music.md",sourceDirName:"projects",slug:"/projects/miniprogram-music",permalink:"/docs/projects/miniprogram-music",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/projects/miniprogram-music.md",tags:[],version:"current",frontMatter:{},sidebar:"projects",next:{title:"\u7cef\u7c73 UI",permalink:"/docs/projects/nuomi-ui-vue"}},r={},o=[{value:"\u5c0f\u7a0b\u5e8f\u4e2d\u4f7f\u7528 iconfont",id:"\u5c0f\u7a0b\u5e8f\u4e2d\u4f7f\u7528-iconfont",level:2},{value:"\u524d\u540e\u7aef\u4ea4\u4e92",id:"\u524d\u540e\u7aef\u4ea4\u4e92",level:2},{value:"\u5c01\u88c5\u8bf7\u6c42\u51fd\u6570",id:"\u5c01\u88c5\u8bf7\u6c42\u51fd\u6570",level:2},{value:"\u7528\u6237\u4f53\u9a8c\u4e0e\u6027\u80fd\u7684\u53d6\u820d",id:"\u7528\u6237\u4f53\u9a8c\u4e0e\u6027\u80fd\u7684\u53d6\u820d",level:2},{value:"\u524d++ \u548c \u540e++ \u8bb0\u5fc6",id:"\u524d-\u548c-\u540e-\u8bb0\u5fc6",level:2},{value:"\u5185\u7f51\u7a7f\u900f &amp; \u771f\u673a\u8c03\u8bd5",id:"\u5185\u7f51\u7a7f\u900f--\u771f\u673a\u8c03\u8bd5",level:2},{value:"\u591a\u4e2a\u89c6\u9891\u540c\u65f6\u64ad\u653e\u7684\u95ee\u9898",id:"\u591a\u4e2a\u89c6\u9891\u540c\u65f6\u64ad\u653e\u7684\u95ee\u9898",level:2},{value:"\u89c6\u9891\u5217\u8868\u9875\u9762\u7684\u6027\u80fd\u4f18\u5316",id:"\u89c6\u9891\u5217\u8868\u9875\u9762\u7684\u6027\u80fd\u4f18\u5316",level:2},{value:"\u8def\u7531\u4f20\u53c2",id:"\u8def\u7531\u4f20\u53c2",level:2},{value:"\u5c0f\u7a0b\u5e8f\u4f7f\u7528 npm \u5305",id:"\u5c0f\u7a0b\u5e8f\u4f7f\u7528-npm-\u5305",level:2},{value:"\u7528\u6237\u767b\u5f55\u83b7\u53d6\u7528\u6237\u552f\u4e00\u6807\u8bc6\uff08openId\uff09",id:"\u7528\u6237\u767b\u5f55\u83b7\u53d6\u7528\u6237\u552f\u4e00\u6807\u8bc6openid",level:2},{value:"\u5206\u5305",id:"\u5206\u5305",level:2},{value:"\u5e38\u89c4\u5206\u5305",id:"\u5e38\u89c4\u5206\u5305",level:3},{value:"\u72ec\u7acb\u5206\u5305",id:"\u72ec\u7acb\u5206\u5305",level:3},{value:"\u5206\u5305\u9884\u4e0b\u8f7d",id:"\u5206\u5305\u9884\u4e0b\u8f7d",level:3}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,t.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"\u5c0f\u7a0b\u5e8f-\u4e91\u97f3\u4e50",children:"\u5c0f\u7a0b\u5e8f-\u4e91\u97f3\u4e50"}),"\n",(0,i.jsx)(n.h2,{id:"\u5c0f\u7a0b\u5e8f\u4e2d\u4f7f\u7528-iconfont",children:"\u5c0f\u7a0b\u5e8f\u4e2d\u4f7f\u7528 iconfont"}),"\n",(0,i.jsxs)(n.p,{children:["\u7531\u4e8e\u5c0f\u7a0b\u5e8f\u4e2d\u4e0d\u652f\u6301 css \u6587\u4ef6\uff0c\u53ea\u652f\u6301 wxss \u6587\u4ef6\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5c06 iconfont \u751f\u6210\u7684 css \u6587\u4ef6\u590d\u5236\u5230\u5c0f\u7a0b\u5e8f\u4e2d\uff0c\u540e\u7f00\u6539\u6210 ",(0,i.jsx)(n.code,{children:".wxss"}),"\u3002"]}),"\n",(0,i.jsxs)(n.p,{children:["\u5982\u679c\u662f\u5168\u5c40\u4f7f\u7528\uff0c\u53ef\u4ee5\u5728 app.wxss \u4e2d\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"@import"})," \u5f15\u5165\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-css",metastring:'title="app.wxss \u4e2d\u5f15\u5165"',children:'@import "/static/iconfont.wxss";\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-html",metastring:'title="\u4f7f\u7528"',children:'<text class="iconfont icon-icon-ranking"></text>\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\u524d\u540e\u7aef\u4ea4\u4e92",children:"\u524d\u540e\u7aef\u4ea4\u4e92"}),"\n",(0,i.jsx)(n.p,{children:"\u6ce8\u610f\u70b9\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u534f\u8bae\u5fc5\u987b\u662f ",(0,i.jsx)(n.code,{children:"https"})," \u534f\u8bae\uff0c\u4f46\u5f00\u53d1\u65f6\u4e5f\u53ef\u4ee5\u8bbe\u7f6e\u4e0d\u6821\u9a8c\u5408\u6cd5\u57df\u540d"]}),"\n",(0,i.jsx)(n.li,{children:"\u4e00\u4e2a\u63a5\u53e3\u6700\u591a\u914d\u7f6e 20 \u4e2a\u57df\u540d"}),"\n",(0,i.jsx)(n.li,{children:"\u5e76\u53d1\u9650\u5236\u4e0a\u9650\u662f 10 \u4e2a"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u5c01\u88c5\u8bf7\u6c42\u51fd\u6570",children:"\u5c01\u88c5\u8bf7\u6c42\u51fd\u6570"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'title="utils/config.js"',children:"export default {\n  host: 'http://localhost:3000',\n  mobileHost: 'http://pnxxvt.natappfree.cc'\n}\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'title="utils/request.js"',children:"import config from './config'\n\nexport default (url, data = {}, method = 'GET') => {\n  return new Promise((resolve, reject) => {\n    wx.request({\n      url: config.host + url,\n      data,\n      method,\n      success: (res) => {\n        // console.log('\u8bf7\u6c42\u6210\u529f:', res)\n        resolve(res.data)\n      },\n      fail: (err) => {\n        // console.log('\u8bf7\u6c42\u5931\u8d25:', err)\n        reject(err)\n      }\n    })\n  })\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u7528\u6237\u4f53\u9a8c\u4e0e\u6027\u80fd\u7684\u53d6\u820d",children:"\u7528\u6237\u4f53\u9a8c\u4e0e\u6027\u80fd\u7684\u53d6\u820d"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"// \u83b7\u53d6\u6392\u884c\u699c\u6570\u636e\nlet index = 0\nlet resultArr = []\nwhile (index < 5) {\n  let topListData = await request('/top/list', { idx: index++ })\n  let topListItem = {\n    name: topListData.playlist.name,\n    tracks: topListData.playlist.tracks.slice(0, 3)\n  }\n  resultArr.push(topListItem)\n  // \u5982\u679c\u5c06 setData \u653e\u5728\u5faa\u73af\u4e2d\uff0c\u5219\u4e0d\u9700\u8981\u7b49\u5f85\u4e94\u6b21\u8bf7\u6c42\u5168\u90e8\u7ed3\u675f\u624d\u66f4\u65b0\uff0c\u7528\u6237\u4f53\u9a8c\u8f83\u597d\uff0c\u4f46\u66f4\u65b0\u6e32\u67d3\u6b21\u6570\u4f1a\u591a\u4e00\u4e9b\n  this.setData({ topList: resultArr })\n}\n\n// \u5982\u679c\u5c06 setData \u653e\u5728\u5faa\u73af\u5916\uff0c\u5219\u4f1a\u5bfc\u81f4\u53d1\u9001\u8bf7\u6c42\u7684\u8fc7\u7a0b\u4e2d\u9875\u9762\u957f\u65f6\u95f4\u767d\u5c4f\uff0c\u7528\u6237\u4f53\u9a8c\u5dee\uff0c\u4f46\u53ea\u9700\u66f4\u65b0\u6e32\u67d3\u4e00\u6b21\n// this.setData({ topList: resultArr })\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u524d-\u548c-\u540e-\u8bb0\u5fc6",children:"\u524d++ \u548c \u540e++ \u8bb0\u5fc6"}),"\n",(0,i.jsx)(n.p,{children:"\u524d++ \u548c \u540e++ \u7684\u533a\u522b\uff1a\u5982\u679c\u5148\u770b\u5230\u7684\u662f\u8fd0\u7b97\u7b26\u5c31\u5148\u8fd0\u7b97\u518d\u8d4b\u503c\uff0c\u5982\u679c\u5148\u770b\u5230\u7684\u503c\u90a3\u4e48\u5c31\u5148\u8d4b\u503c\u518d\u8fd0\u7b97\u3002"}),"\n",(0,i.jsx)(n.h2,{id:"\u5185\u7f51\u7a7f\u900f--\u771f\u673a\u8c03\u8bd5",children:"\u5185\u7f51\u7a7f\u900f & \u771f\u673a\u8c03\u8bd5"}),"\n",(0,i.jsxs)(n.p,{children:["\u4e0b\u8f7d ",(0,i.jsx)(n.a,{href:"https://natapp.cn/",children:"natapp"})," \u5e76\u5b89\u88c5\uff0c\u968f\u540e\u53cc\u51fb\u6253\u5f00\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"\u771f\u673a\u8c03\u8bd5\u65f6\u4f7f\u7528\u5982\u4e0b\u8def\u5f84\uff1a"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"img.png",src:s(7896).Z+"",width:"648",height:"279"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'title="utils/config.js"',children:"// \u914d\u7f6e\u670d\u52a1\u5668\u76f8\u5173\u4fe1\u606f\nexport default {\n  host: 'http://localhost:3000',\n  // highlight-next-line\n  mobileHost: 'http://mkx8kn.natappfree.cc'\n}\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'title="utils/request.js"',children:"import config from './config'\n\nexport default (url, data = {}, method = 'GET') => {\n  return new Promise((resolve, reject) => {\n    wx.request({\n      // highlight-next-line\n      url: config.mobileHost + url,\n      data,\n      method,\n      success: (res) => {\n        resolve(res.data)\n      },\n      fail: (err) => {\n        reject(err)\n      }\n    })\n  })\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u591a\u4e2a\u89c6\u9891\u540c\u65f6\u64ad\u653e\u7684\u95ee\u9898",children:"\u591a\u4e2a\u89c6\u9891\u540c\u65f6\u64ad\u653e\u7684\u95ee\u9898"}),"\n",(0,i.jsx)(n.p,{children:"\u6b63\u5e38\u6765\u8bf4\uff0c\u5728\u64ad\u653e\u65b0\u7684\u89c6\u9891\u4e4b\u524d\uff0c\u9700\u8981\u6682\u505c\u4e0a\u4e00\u4e2a\u6b63\u5728\u64ad\u653e\u7684\u89c6\u9891\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u5b9e\u73b0\u8fd9\u4e2a\u9700\u6c42\u7684\u5173\u952e\u6709\u4e24\u70b9\uff1a"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"\u5982\u4f55\u627e\u5230\u4e0a\u4e00\u4e2a\u89c6\u9891\u7684\u5b9e\u4f8b\u5bf9\u8c61\uff0c\u8ba9\u5b83\u6682\u505c"}),"\n",(0,i.jsx)(n.li,{children:"\u5982\u4f55\u786e\u8ba4\u70b9\u51fb\u64ad\u653e\u7684\u89c6\u9891\u548c\u6b63\u5728\u64ad\u653e\u7684\u89c6\u9891\u4e0d\u662f\u540c\u4e00\u4e2a\u89c6\u9891"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5355\u4f8b\u6a21\u5f0f\uff1a"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"\u9700\u8981\u521b\u5efa\u591a\u4e2a\u5bf9\u8c61\u7684\u573a\u666f\u4e0b\uff0c\u901a\u8fc7\u4e00\u4e2a\u53d8\u91cf\u63a5\u6536\uff0c\u59cb\u7ec8\u4fdd\u6301\u53ea\u6709\u4e00\u4e2a\u5bf9\u8c61"}),"\n",(0,i.jsx)(n.li,{children:"\u8282\u7701\u5185\u5b58\u7a7a\u95f4"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'title="\u793a\u4f8b\u4ee3\u7801"',children:"handlePlay(event) {\n  // \u83b7\u53d6\u5f53\u524d\u89c6\u9891\u7684 id\n  let vid = event.currentTarget.id\n  // \u5173\u95ed\u4e0a\u4e00\u4e2a\u64ad\u653e\u7684\u89c6\u9891\n  // this.vid !== vid \u8868\u793a\u70b9\u51fb\u7684\u4e0d\u662f\u5f53\u524d\u6b63\u5728\u64ad\u653e\u7684\u89c6\u9891\n  // this.videoContext \u8868\u793a\u5df2\u7ecf\u5b58\u5728\u89c6\u9891\u5b9e\u4f8b\uff0c\u5373\u5df2\u7ecf\u6709\u89c6\u9891\u6b63\u5728\u64ad\u653e\n  this.vid !== vid && this.videoContext && this.videoContext.stop()\n  this.vid = vid\n  // \u6839\u636e\u89c6\u9891 id\uff0c\u521b\u5efa\u63a7\u5236 video \u6807\u7b7e\u7684\u5b9e\u4f8b\u5bf9\u8c61\n  this.videoContext = wx.createVideoContext(vid)\n  // \u64ad\u653e\u89c6\u9891\n  this.videoContext.play()\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u89c6\u9891\u5217\u8868\u9875\u9762\u7684\u6027\u80fd\u4f18\u5316",children:"\u89c6\u9891\u5217\u8868\u9875\u9762\u7684\u6027\u80fd\u4f18\u5316"}),"\n",(0,i.jsxs)(n.p,{children:["\u601d\u8def\uff1a\u5f53\u89c6\u9891\u9700\u8981\u64ad\u653e\u65f6\uff0c\u624d\u663e\u793a ",(0,i.jsx)(n.code,{children:"video"})," \u6807\u7b7e\uff0c\u5426\u5219\u4ee5 ",(0,i.jsx)(n.code,{children:"image"})," \u6807\u7b7e\u4ee3\u66ff\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-html",children:'<video\n  wx:if=\'{{videoId === item.data.vid}}\'\n  id="{{item.data.vid}}" src="{{item.data.urlInfo.url}}" poster="{{item.data.coverUrl}}" object-fit="cover"\n  class="common"\n  bindplay="handlePlay" bindtimeupdate="handleTimeUpdate" bindended="handleEnded"\n></video>\n\x3c!-- \u6027\u80fd\u4f18\u5316\uff1a\u4f7f\u7528 image \u4ee3\u66ff video \u6807\u7b7e --\x3e\n<image\n  wx:else\n  id="{{item.data.vid}}" src="{{item.data.coverUrl}}"\n  class="common"\n  bindtap="handlePlay"\n></image>\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"// \u5f53\u70b9\u51fb image \u66ff\u6362\u6210 video \u65f6\uff0c\u5176\u4ed6\u6b63\u5728\u64ad\u653e\u7684 video \u5b9e\u4f8b\u4f1a\u88ab\u9500\u6bc1\uff0c\u6240\u4ee5\u65e0\u9700\u4f7f\u7528 stop \u65b9\u6cd5\u6682\u505c\u5176\u4ed6\u89c6\u9891\nhandlePlay(event) {\n  let vid = event.currentTarget.id\n  // \u66f4\u65b0 data \u4e2d videoId \u7684\u72b6\u6001\u6570\u636e\n  this.setData({ videoId: vid })\n  // \u521b\u5efa\u63a7\u5236\u5f53\u524d video \u6807\u7b7e\u7684\u5b9e\u4f8b\u5bf9\u8c61\n  this.videoContext = wx.createVideoContext(vid)\n  // \u5224\u65ad\u5f53\u524d\u7684\u89c6\u9891\u4e4b\u524d\u662f\u5426\u64ad\u653e\u8fc7\uff0c\u662f\u5426\u6709\u64ad\u653e\u8bb0\u5f55\uff0c\u5982\u679c\u6709\uff0c\u8df3\u8f6c\u81f3\u6307\u5b9a\u7684\u64ad\u653e\u4f4d\u7f6e\n  let { videoUpdateTime } = this.data\n  let videoItem = videoUpdateTime.find(item => item.vid === vid)\n  if (videoItem) this.videoContext.seek(videoItem.currentTime)\n  this.videoContext.play()\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u8def\u7531\u4f20\u53c2",children:"\u8def\u7531\u4f20\u53c2"}),"\n",(0,i.jsx)(n.p,{children:"\u5c0f\u7a0b\u5e8f\u4e2d\u5bf9\u8def\u7531\u4f20\u53c2\u7684\u53c2\u6570\u957f\u5ea6\u6709\u9650\u5236\uff0c\u5982\u679c\u53c2\u6570\u957f\u5ea6\u8fc7\u957f\uff0c\u4f1a\u88ab\u622a\u53d6\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"// \u4e0d\u63a8\u8350\nwx.navigateTo({ url: '/songPackage/pages/songDetail/songDetail?song=' + JSON.stringify(song) })\n\n// \u63a8\u8350\nwx.navigateTo({ url: '/songPackage/pages/songDetail/songDetail?musicId=' + song.id })\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u4f20\u9012\u7684\u53c2\u6570\u53ef\u4ee5\u5728\u8df3\u8f6c\u9875\u9762\u7684 ",(0,i.jsx)(n.code,{children:"onLoad"})," \u4e2d\u63a5\u6536\u5230\uff08",(0,i.jsx)(n.code,{children:"options"}),"\uff09\u3002"]}),"\n",(0,i.jsx)(n.h2,{id:"\u5c0f\u7a0b\u5e8f\u4f7f\u7528-npm-\u5305",children:"\u5c0f\u7a0b\u5e8f\u4f7f\u7528 npm \u5305"}),"\n",(0,i.jsx)(n.p,{children:"\u4ee5 pubsub \u4e3a\u4f8b\uff0c\u5b9e\u73b0\u5c0f\u7a0b\u5e8f\u9875\u9762\u4e4b\u95f4\u7684\u901a\u4fe1\uff1a"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["\u521d\u59cb\u5316 package.json\uff1a",(0,i.jsx)(n.code,{children:"npm init"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"\u52fe\u9009\u5141\u8bb8\u4f7f\u7528 npm"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["\u4e0b\u8f7d npm \u5305\uff1a",(0,i.jsx)(n.code,{children:"npm install pubsub-js"})]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["\u6784\u5efa npm\uff1a\u201c\u5f00\u53d1\u5de5\u5177 -> \u5de5\u5177 -> \u6784\u5efa npm\u201d\uff0c\u4f1a\u5c06 ",(0,i.jsx)(n.code,{children:"node_modules"})," \u4e2d\u7684\u5305\u6253\u5305\u5230 ",(0,i.jsx)(n.code,{children:"miniprogram_npm"})," \u4e2d\uff0c\u968f\u540e\u5c0f\u7a0b\u5e8f\u5c31\u5230 ",(0,i.jsx)(n.code,{children:"miniprogram_npm"})," \u4e2d\u5bfb\u627e\u5bf9\u5e94\u7684\u5305"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"\u4f7f\u7528"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'title="pageA"',children:"import PubSub from 'pubsub-js'\n\n// \u8ba2\u9605\nPubSub.subscribe('switchType', (msg, type) => {\n  // ...\n})\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'title="pageB"',children:"import PubSub from 'pubsub-js'\n\n// \u53d1\u5e03\nPubSub.publish('switchType', 'next')\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u7528\u6237\u767b\u5f55\u83b7\u53d6\u7528\u6237\u552f\u4e00\u6807\u8bc6openid",children:"\u7528\u6237\u767b\u5f55\u83b7\u53d6\u7528\u6237\u552f\u4e00\u6807\u8bc6\uff08openId\uff09"}),"\n",(0,i.jsxs)(n.p,{children:["\u524d\u7aef\u8c03\u7528 ",(0,i.jsx)(n.code,{children:"wx.login"})," \u63a5\u53e3\u8ba9\u7528\u6237\u767b\u5f55\uff0c\u83b7\u53d6\u7528\u6237\u7684 ",(0,i.jsx)(n.code,{children:"code"}),"\u3002"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'title="\u524d\u7aef\u4ee3\u7801\u793a\u4f8b"',children:"// \u83b7\u53d6\u7528\u6237 openId\nhandleGetOpenId() {\n  // \u83b7\u53d6\u767b\u5f55\u51ed\u8bc1\n  wx.login({\n    success: async (res) => {\n      let code = res.code\n      // \u5c06\u767b\u5f55\u51ed\u8bc1\u53d1\u9001\u670d\u52a1\u5668\n      let result = await request('/getOpenId', { code })\n      console.log(result)\n    }\n  })\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u540e\u7aef\u6536\u5230\u524d\u7aef\u4f20\u8fc7\u6765\u7684 ",(0,i.jsx)(n.code,{children:"code"}),"\uff0c\u7136\u540e\u62ff\u7740\u5c0f\u7a0b\u5e8f\u7684 ",(0,i.jsx)(n.code,{children:"appId"})," \u548c ",(0,i.jsx)(n.code,{children:"appSecret"})," \u5411\u5fae\u4fe1\u670d\u52a1\u5668\u53d1\u8bf7\u6c42\uff0c\u83b7\u53d6\u5230\u7528\u6237\u7684 ",(0,i.jsx)(n.code,{children:"openId"}),"\uff0c\u4e0e\u7528\u6237\u4fe1\u606f\u4e00\u8d77\u8fdb\u884c\u52a0\u5bc6\uff0c\u751f\u6210\u7528\u6237 ",(0,i.jsx)(n.code,{children:"token"})," \u8fd4\u56de\u7ed9\u524d\u7aef\u3002\uff08",(0,i.jsx)(n.code,{children:"token"})," \u662f\u7528\u6237\u8eab\u4efd\u7684\u6807\u8bc6\uff09"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",metastring:'title="\u540e\u7aef\u4ee3\u7801\u793a\u4f8b"',children:"// \u6ce8\u518c\u83b7\u53d6\u7528\u6237\u552f\u4e00\u6807\u8bc6\u7684\u63a5\u53e3\napp.use('/getOpenId', async (req, res, next) => {\n  let code = req.query.code\n  let appId = 'wx810e8b1fde386fde'\n  let appSecret = '8bb909649da12002fba7a47f5ac3791b'\n  let url = `https://api.weixin.qq.com/sns/jscode2session?appid=${appId}&secret=${appSecret}&js_code=${code}&grant_type=authorization_code`\n  // \u53d1\u8bf7\u6c42\u7ed9\u5fae\u4fe1\u670d\u52a1\u5668\u83b7\u53d6 openId\n  let result = await fly.get(url)\n  let openId = JSON.parse(result.data).openid\n   console.log('openId', openId)\n   // \u81ea\u5b9a\u4e49\u767b\u5f55\u6001\n   let person = { username: '\u5f20\u4e09', age: 18, openId }\n   // \u5bf9\u7528\u6237\u7684\u6570\u636e\u8fdb\u884c\u52a0\u5bc6\uff0c\u751f\u6210 token \u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\n  let token = jwt.sign(person, 'atguigu')\n  console.log(token)\n  // \u9a8c\u8bc1\u8eab\u4efd\uff0c\u53cd\u7f16\u8bd1 token\n  let result2 = jwt.verify(token, 'atguigu')\n  console.log(result2)\n  res.send(token)\n})\n"})}),"\n",(0,i.jsx)(n.h2,{id:"\u5206\u5305",children:"\u5206\u5305"}),"\n",(0,i.jsx)(n.h3,{id:"\u5e38\u89c4\u5206\u5305",children:"\u5e38\u89c4\u5206\u5305"}),"\n",(0,i.jsxs)(n.p,{children:["\u5728 app.json \u7684 ",(0,i.jsx)(n.code,{children:"subpackages"})," \u4e2d\u58f0\u660e\u9879\u76ee\u5206\u5305\u7ed3\u6784\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"\u7279\u70b9\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u5c0f\u7a0b\u5e8f\u5728\u52a0\u8f7d\u65f6\u5148\u52a0\u8f7d\u4e3b\u5305\uff0c\u5f53\u9700\u8981\u8bbf\u95ee\u5206\u5305\u9875\u9762\u7684\u65f6\u5019\u518d\u52a0\u8f7d\u5206\u5305\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"\u5206\u5305\u7684\u9875\u9762\u53ef\u4ee5\u8bbf\u95ee\u4e3b\u5305\u7684\u6587\u4ef6\u3001\u6570\u636e\u3001\u56fe\u7247\u7b49\u8d44\u6e90\uff1b"}),"\n",(0,i.jsxs)(n.li,{children:["\u4e3b\u5305\uff1a","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u4e3b\u5305\u6765\u6e90\uff1a\u9664\u4e86\u5206\u5305\u4ee5\u5916\uff0c\u5176\u4ed6\u5185\u5bb9\u90fd\u4f1a\u6253\u5305\u5230\u4e3b\u5305\u4e2d"}),"\n",(0,i.jsx)(n.li,{children:"\u4e00\u822c\u6765\u8bf4\uff0c\u9996\u9875\u3001tabBar \u901a\u5e38\u4f1a\u653e\u5728\u4e3b\u5305\uff0c\u4e00\u4e0a\u6765\u4e0d\u663e\u793a\u7684\u9875\u9762\u53ef\u4ee5\u8fdb\u884c\u5206\u5305"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u76ee\u5f55\u7ed3\u6784\uff1a"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"img_1.png",src:s(7197).Z+"",width:"295",height:"484"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n   // \u4e3b\u5305\n   "pages": [\n      "pages/login/login",\n      "pages/index/index",\n      "pages/search/search",\n      "pages/video/video",\n      "pages/personal/personal"\n   ],\n   // \u5206\u5305\n   // \u5206\u5305\u7684\u9875\u9762\u8def\u5f84\uff0c\u5c31\u4e0d\u9700\u8981\u518d\u5305\u542b\u5728\u4e3b\u5305\u4e2d\u4e86\n   "subpackages": [\n      {\n         "root": "songPackage",\n         "pages": [\n            "pages/recommendSong/recommendSong",\n            "pages/songDetail/songDetail"\n         ]\n      },\n      // \u53ef\u4ee5\u6709\u591a\u4e2a\u5206\u5305\n      {\n         "root": "otherPackage",\n         "name": "other",\n         "pages": [\n            "pages/other/other"\n         ]\n      }\n   ]\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u5206\u5305\u540e\uff0c\u9875\u9762\u8df3\u8f6c\u7684\u8def\u5f84\u9700\u8981\u66f4\u6539\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-js",children:"// \u4fee\u6539\u524d\nwx.navigateTo({ url: '/pages/recommendSong/recommendSong' })\n\n// \u4fee\u6539\u540e\nwx.navigateTo({ url: '/songPackage/pages/recommendSong/recommendSong' })\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\u72ec\u7acb\u5206\u5305",children:"\u72ec\u7acb\u5206\u5305"}),"\n",(0,i.jsxs)(n.p,{children:["\u8bbe\u7f6e ",(0,i.jsx)(n.code,{children:"independent"})," \u4e3a ",(0,i.jsx)(n.code,{children:"true"}),"\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"\u7279\u70b9\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u53ef\u5355\u72ec\u8bbf\u95ee\u5206\u5305\u7684\u5185\u5bb9\uff0c\u4e0d\u9700\u8981\u4e0b\u8f7d\u4e3b\u5305\uff1b"}),"\n",(0,i.jsx)(n.li,{children:"\u4e0d\u80fd\u4f9d\u8d56\u4e3b\u5305\u6216\u5176\u4ed6\u5305\u7684\u5185\u5bb9\u3002"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u4f7f\u7528\u573a\u666f\uff1a\u901a\u5e38\u67d0\u4e9b\u9875\u9762\u548c\u5f53\u524d\u5c0f\u7a0b\u5e8f\u7684\u5176\u4ed6\u9875\u9762\u5173\u8054\u4e0d\u5927\u65f6\uff0c\u53ef\u8fdb\u884c\u72ec\u7acb\u5206\u5305\uff0c\u6bd4\u5982\u4e34\u65f6\u52a0\u7684\u5e7f\u544a\u9875\u3001\u6d3b\u52a8\u9875\u7b49\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n   // \u4e3b\u5305\n   "pages": [\n      "pages/login/login",\n      "pages/index/index",\n      "pages/search/search",\n      "pages/video/video",\n      "pages/personal/personal"\n   ],\n   // \u5206\u5305\n   "subpackages": [\n      {\n         "root": "songPackage",\n         "pages": [\n            "pages/recommendSong/recommendSong",\n            "pages/songDetail/songDetail"\n         ],\n         // \u72ec\u7acb\u5206\u5305\n         "independent": true\n      },\n      {\n         "root": "otherPackage",\n         "name": "other",\n         "pages": [\n            "pages/other/other"\n         ]\n      }\n   ]\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u4ee5\u4e0a\u4ee3\u7801\uff0c\u5c06 songPackage \u8fdb\u884c\u72ec\u7acb\u5206\u5305\uff0c\u90a3\u4e48\u72ec\u7acb\u5206\u5305\u4e2d\u7684\u9875\u9762\u4e0d\u80fd\u4f9d\u8d56\u5176\u4ed6\u5305\uff0c\u4f8b\u5982\u65e0\u6cd5\u4f7f\u7528\u516c\u5171\u6837\u5f0f\uff0c\u9700\u8981\u5355\u72ec\u5f15\u5165\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-css",metastring:'title="recommendSong.wxss"',children:'@import "/static/iconfont/iconfont.wxss";\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-css",metastring:'title="songDetail.wxss"',children:'@import "/static/iconfont/iconfont.wxss";\n'})}),"\n",(0,i.jsx)(n.h3,{id:"\u5206\u5305\u9884\u4e0b\u8f7d",children:"\u5206\u5305\u9884\u4e0b\u8f7d"}),"\n",(0,i.jsxs)(n.p,{children:["app.json \u4e2d\u8bbe\u7f6e ",(0,i.jsx)(n.code,{children:"preloadRule"})," \u9009\u9879\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"\u6ce8\u610f\uff1a\u5728\u72ec\u7acb\u5206\u5305\u65f6\uff0c\u53ef\u4ee5\u9884\u52a0\u8f7d\u4e3b\u5305\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "pages": [\n    "pages/index/index",\n    "pages/search/search",\n    "pages/video/video",\n    "pages/login/login",\n    "pages/personal/personal"\n  ],\n  "subpackages": [\n    {\n      "root": "songPackage",\n      "pages": [\n        "pages/recommendSong/recommendSong",\n        "pages/songDetail/songDetail"\n      ],\n      "independent": true\n    },\n    {\n      "root": "otherPackage",\n      "name": "other",\n      "pages": [\n        "pages/other/other"\n      ]\n    }\n  ],\n  "preloadRule": {\n    // \u5728 index \u9875\u9762\u9884\u52a0\u8f7d songPackage \u548c other \u5305\n    "pages/index/index": {\n      // \u53ef\u4ee5\u901a\u8fc7\u5305\u7684 root \u6216 name \u6307\u5b9a\u5305\n      "packages": ["songPackage", "other"]\n    }\n  }\n}\n'})})]})}function p(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},7896:(e,n,s)=>{s.d(n,{Z:()=>i});const i=s.p+"assets/images/img-4f3f325a3dc08a523af4b1e229b2c2b4.png"},7197:(e,n,s)=>{s.d(n,{Z:()=>i});const i=s.p+"assets/images/img_1-f29d1150ad2382a2a165199dbc5397fc.png"},1151:(e,n,s)=>{s.d(n,{Z:()=>a,a:()=>d});var i=s(7294);const t={},l=i.createContext(t);function d(e){const n=i.useContext(l);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);