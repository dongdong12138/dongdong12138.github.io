"use strict";(self.webpackChunkdongdong_12138_github_io=self.webpackChunkdongdong_12138_github_io||[]).push([[6174],{6196:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>a,toc:()=>l});var s=t(5893),r=t(1151);const o={sidebar_position:17},i="Pinia\u3001Vuex",a={id:"front-frame/Vue3/Pinia\u3001Vuex",title:"Pinia\u3001Vuex",description:"Pinia \u548c Vuex \u90fd\u662f\u96c6\u4e2d\u5f0f\u72b6\u6001\u7ba1\u7406\u5e93\u3002",source:"@site/docs/front-frame/Vue3/17-Pinia\u3001Vuex.md",sourceDirName:"front-frame/Vue3",slug:"/front-frame/Vue3/Pinia\u3001Vuex",permalink:"/docs/front-frame/Vue3/Pinia\u3001Vuex",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/front-frame/Vue3/17-Pinia\u3001Vuex.md",tags:[],version:"current",sidebarPosition:17,frontMatter:{sidebar_position:17},sidebar:"front-frame",previous:{title:"\u8def\u7531",permalink:"/docs/front-frame/Vue3/\u8def\u7531"},next:{title:"\u7ec4\u4ef6\u901a\u4fe1",permalink:"/docs/front-frame/Vue3/\u7ec4\u4ef6\u901a\u4fe1"}},c={},l=[{value:"Pinia",id:"pinia",level:2},{value:"\u642d\u5efa Pinia \u73af\u5883",id:"\u642d\u5efa-pinia-\u73af\u5883",level:3},{value:"\u5b58\u50a8 + \u8bfb\u53d6\u6570\u636e",id:"\u5b58\u50a8--\u8bfb\u53d6\u6570\u636e",level:3},{value:"\u4fee\u6539\u6570\u636e",id:"\u4fee\u6539\u6570\u636e",level:3},{value:"\u91cd\u7f6e",id:"\u91cd\u7f6e",level:3},{value:"storeToRefs",id:"storetorefs",level:3},{value:"getters",id:"getters",level:3},{value:"$subscribe",id:"subscribe",level:3},{value:"store \u7ec4\u5408\u5f0f\u5199\u6cd5",id:"store-\u7ec4\u5408\u5f0f\u5199\u6cd5",level:3},{value:"Vuex",id:"vuex",level:2},{value:"\u57fa\u672c\u4f7f\u7528",id:"\u57fa\u672c\u4f7f\u7528",level:3},{value:"\u8f85\u52a9\u51fd\u6570",id:"\u8f85\u52a9\u51fd\u6570",level:3},{value:"Module",id:"module",level:3},{value:"vuex \u6301\u4e45\u5316\u63d2\u4ef6",id:"vuex-\u6301\u4e45\u5316\u63d2\u4ef6",level:3}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"piniavuex",children:"Pinia\u3001Vuex"}),"\n",(0,s.jsx)(n.p,{children:"Pinia \u548c Vuex \u90fd\u662f\u96c6\u4e2d\u5f0f\u72b6\u6001\u7ba1\u7406\u5e93\u3002"}),"\n",(0,s.jsx)(n.p,{children:"Pinia \u4e0e Vuex \u7684\u4e0d\u540c\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Vuex \u4e2d\u7684 ",(0,s.jsx)(n.code,{children:"mutation"})," \u88ab\u5f03\u7528\uff0c\u5b83\u4eec\u7ecf\u5e38\u88ab\u8ba4\u4e3a\u662f\u6781\u5176\u5197\u4f59\u7684\uff0c\u5b83\u4eec\u521d\u8877\u662f\u5e26\u6765 devtools \u7684\u96c6\u6210\u65b9\u6848"]}),"\n",(0,s.jsx)(n.li,{children:"Pinia \u5bf9 TypeScript \u7684\u652f\u6301\u66f4\u53cb\u597d"}),"\n",(0,s.jsx)(n.li,{children:"Pinia \u53ef\u4ee5\u50cf Vuex \u90a3\u6837\u4f7f\u7528\u9009\u9879\u5f0f API\uff0c\u4f46 Pinia \u4e5f\u53ef\u4ee5\u4f7f\u7528\u7ec4\u5408\u5f0f API"}),"\n",(0,s.jsx)(n.li,{children:"Pinia \u4e0d\u518d\u6709\u53ef\u547d\u540d\u7684\u6a21\u5757\uff08Vuex \u4e2d\u7684\u201c\u547d\u540d\u7a7a\u95f4\u201d\uff09"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"pinia",children:"Pinia"}),"\n",(0,s.jsxs)(n.h3,{id:"\u642d\u5efa-pinia-\u73af\u5883",children:["\u642d\u5efa ",(0,s.jsx)(n.a,{href:"https://pinia.vuejs.org/zh/",children:"Pinia"})," \u73af\u5883"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",metastring:'title="\u5b89\u88c5"',children:"npm install pinia\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",metastring:'title="src/main.ts"',children:"import { createApp } from 'vue'\n// \u5f15\u5165 createPinia\nimport { createPinia } from 'pinia'\nimport App from './App.vue'\n\nconst app = createApp(App)\n// \u521b\u5efa pinia\nconst pinia = createPinia()\n\n// \u4f7f\u7528 pinia\napp.use(pinia)      // \u6b64\u65f6\u5f00\u53d1\u8005\u5de5\u5177\u4e2d\u5df2\u7ecf\u6709\u4e86 pinia \u9009\u9879\napp.mount('#app')\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u5b58\u50a8--\u8bfb\u53d6\u6570\u636e",children:"\u5b58\u50a8 + \u8bfb\u53d6\u6570\u636e"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"Store"})," \u662f\u4e00\u4e2a\u4fdd\u5b58",(0,s.jsx)(n.strong,{children:"\u72b6\u6001"}),"\u3001",(0,s.jsx)(n.strong,{children:"\u4e1a\u52a1\u903b\u8f91"}),"\u7684\u5b9e\u4f53\uff0c\u6bcf\u4e2a\u7ec4\u4ef6\u90fd\u53ef\u4ee5",(0,s.jsx)(n.strong,{children:"\u8bfb\u53d6"}),"\u3001",(0,s.jsx)(n.strong,{children:"\u5199\u5165"}),"\u5b83\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u5b83\u6709\u4e09\u4e2a\u6982\u5ff5\uff1a",(0,s.jsx)(n.code,{children:"state"}),"\u3001",(0,s.jsx)(n.code,{children:"getter"}),"\u3001",(0,s.jsx)(n.code,{children:"action"}),"\uff0c\u76f8\u5f53\u4e8e\u7ec4\u4ef6\u4e2d\u7684\uff1a",(0,s.jsx)(n.code,{children:"data"}),"\u3001",(0,s.jsx)(n.code,{children:"computed"})," \u548c ",(0,s.jsx)(n.code,{children:"methods"}),"\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",metastring:'title="src/store/count.ts"',children:"// \u5f15\u5165 defineStore \u7528\u4e8e\u521b\u5efa store\nimport { defineStore } from 'pinia'\n\n// \u5b9a\u4e49\u5e76\u66b4\u9732\u4e00\u4e2a store\nexport const useCountStore = defineStore('count', {\n  // \u72b6\u6001\n  state: () => {   // \u63a8\u8350\u4f7f\u7528\u7bad\u5934\u51fd\u6570\uff0c\u66f4\u6709\u5229\u4e8e TS \u7684\u7c7b\u578b\u63a8\u65ad\n    return {\n      sum: 6\n    }\n  },\n  // \u8ba1\u7b97\n  getters: {},\n  // \u52a8\u4f5c\n  actions: {},\n})\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",metastring:'title="\u7ec4\u4ef6\u4e2d\u4f7f\u7528 state \u4e2d\u7684\u6570\u636e"',children:'<template>\n  <h2>\u5f53\u524d\u6c42\u548c\u4e3a\uff1a{{ countStore.sum }}</h2>\n</template>\n\n<script setup lang="ts" name="Count">\n  import { useCountStore } from \'@/store/count\'\n  \n  // countStore \u662f\u4e00\u4e2a Proxy \u54cd\u5e94\u5f0f\u5bf9\u8c61\n  const countStore = useCountStore()\n  \n  // \u4ee5\u4e0b\u4e24\u79cd\u65b9\u5f0f\u90fd\u53ef\u4ee5\u62ff\u5230 state \u4e2d\u7684\u6570\u636e\n  // \u4e0b\u9762\u7b2c\u4e00\u4e2a log \u4e2d\u7684 sum \u662f\u4e00\u4e2a ref \u5bf9\u8c61\n  // \u7531\u4e8e\u5b83\u662f\u5728 countStore \u4e2d\u7684\uff0ccountStore \u662f\u4e00\u4e2a Proxy \u5bf9\u8c61\uff0c\u6240\u4ee5\u4f1a\u81ea\u52a8\u89e3\u5305\uff0c\u4e0d\u7528 .value\n  console.log(countStore.sum)\n  console.log(countStore.$state.sum)\n<\/script>\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",metastring:'title="src/store/talk.ts"',children:"// \u5f15\u5165 defineStore \u7528\u4e8e\u521b\u5efa store\nimport { defineStore } from 'pinia'\n\n// \u5b9a\u4e49\u5e76\u66b4\u9732\u4e00\u4e2a store\nexport const useTalkStore = defineStore('talk', {\n  // \u72b6\u6001\n  state: () => {\n    return {\n      talkList: [\n        { id: 'yuysada01', content: '\u4f60\u4eca\u5929\u6709\u70b9\u602a\uff0c\u54ea\u91cc\u602a\uff1f\u602a\u597d\u770b\u7684\uff01' },\n        { id: 'yuysada02', content: '\u8349\u8393\u3001\u84dd\u8393\u3001\u8513\u8d8a\u8393\uff0c\u4f60\u60f3\u6211\u4e86\u6ca1\uff1f' },\n        { id: 'yuysada03', content: '\u5fc3\u91cc\u7ed9\u4f60\u7559\u4e86\u4e00\u5757\u5730\uff0c\u6211\u7684\u6b7b\u5fc3\u584c\u5730' }\n      ]\n    }\n  },\n  // \u8ba1\u7b97\n  getters: {},\n  // \u52a8\u4f5c\n  actions: {}\n})\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",metastring:'title="\u7ec4\u4ef6\u4e2d\u4f7f\u7528 state \u4e2d\u7684\u6570\u636e"',children:'<template>\n  <ul>\n    <li v-for="talk in talkStore.talkList" :key="talk.id">{{ talk.content }}</li>\n  </ul>\n</template>\n\n<script setup lang="ts" name="Count">\n  import { useTalkStore } from \'@/store/talk\'\n\n  const talkStore = useTalkStore()\n<\/script>\n'})}),"\n",(0,s.jsx)(n.h3,{id:"\u4fee\u6539\u6570\u636e",children:"\u4fee\u6539\u6570\u636e"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u76f4\u63a5\u4fee\u6539"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { useCountStore } from '@/store/count'\n\nconst countStore = useCountStore()\ncountStore.sum = 666\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsx)(n.p,{children:"Vuex \u4e2d\u662f\u4e0d\u53ef\u4ee5\u76f4\u63a5\u4fee\u6539\u6570\u636e\u7684\uff0c\u5fc5\u987b\u64cd\u4f5c Mutation \u6216 Action \u4e2d\u7684\u65b9\u6cd5\u624d\u80fd\u4fee\u6539 State \u4e2d\u7684\u6570\u636e\u3002"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u6279\u91cf\u4fee\u6539"})}),"\n",(0,s.jsxs)(n.p,{children:["\u5982\u679c\u8981\u4e00\u6b21\u4fee\u6539\u591a\u6761\u6570\u636e\uff0c\u63a8\u8350\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"$patch"})," \u65b9\u6cd5\uff0c\u8fdb\u884c\u6279\u91cf\u4fee\u6539\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { useCountStore } from '@/store/count'\n\nconst countStore = useCountStore()\n// \u8865\u4e01\u7684\u5bf9\u8c61\u4f1a\u4e0e state \u4e2d return \u7684\u5bf9\u8c61\u8fdb\u884c\u5408\u5e76\ncountStore.$patch({\n  sum: 999,\n  school: 'atguigu'\n})\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"\u501f\u52a9 actions \u4fee\u6539"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"actions"})," \u4e2d\u53ef\u4ee5\u7f16\u5199\u4e00\u4e9b\u4e1a\u52a1\u903b\u8f91\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { defineStore } from 'pinia'\n\nexport const useCountStore = defineStore('count', {\n  // ...\n  actions: {\n    increment(value: number) {\n      // actions \u4e2d\u7684 this \u6307\u5411\u7684\u662f\u5f53\u524d store \u5b9e\u4f8b\uff0c\u6240\u4ee5\u901a\u8fc7 this \u53ef\u4ee5\u8bbf\u95ee\u5230 state \u4e2d\u7684\u6570\u636e\n      if (this.sum < 10) {\n        this.sum += value\n      }\n    },\n    decrement(value: number) {\n      if (this.sum > 1) {\n        this.sum -= value\n      }\n    }\n  },\n})\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",metastring:'title="\u7ec4\u4ef6\u4e2d\u8c03\u7528 actions \u4e2d\u7684\u65b9\u6cd5"',children:"import { useCountStore } from '@/store/count'\n\nconst countStore = useCountStore()\ncountStore.incrementOdd(value)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u91cd\u7f6e",children:"\u91cd\u7f6e"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { useCountStore } from '@/store/count'\n\nconst countStore = useCountStore()\n// \u91cd\u7f6e store \u4e3a\u539f\u59cb\u503c\ncountStore.$reset()\n"})}),"\n",(0,s.jsx)(n.h3,{id:"storetorefs",children:"storeToRefs"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"store"})," \u662f\u4e00\u4e2a ",(0,s.jsx)(n.code,{children:"reactive"})," \u54cd\u5e94\u5f0f\u5bf9\u8c61\uff0c\u76f4\u63a5\u4ece ",(0,s.jsx)(n.code,{children:"store"})," \u4e2d\u89e3\u6784\u51fa\u7684\u6570\u636e\uff0c\u4f1a\u5931\u53bb\u54cd\u5e94\u5f0f\u3002\u6240\u4ee5 Pinia \u4e5f\u63d0\u4f9b\u4e86 ",(0,s.jsx)(n.code,{children:"storeToRefs"})," \u65b9\u6cd5\uff0c\u7528\u4e8e\u5c06 ",(0,s.jsx)(n.code,{children:"store"})," \u4e2d\u7684\u6570\u636e\u8f6c\u4e3a ",(0,s.jsx)(n.code,{children:"ref"})," \u5bf9\u8c61\uff0c\u4fdd\u6301\u54cd\u5e94\u5f0f\uff0c\u4e5f\u65b9\u4fbf\u5728\u6a21\u677f\u4e2d\u4f7f\u7528\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:"<template>\n  <h2>\u5f53\u524d\u6c42\u548c\u4e3a\uff1a{{ sum }}</h2>\n</template>\n\n<script setup lang=\"ts\">\n  import { storeToRefs } from 'pinia'\n  import { useCountStore } from '@/store/count'\n\n  const countStore = useCountStore()\n  // \u89e3\u6784\u51fa\u7684 sum \u4ecd\u7136\u662f\u6709\u54cd\u5e94\u5f0f\u7684\n  const { sum } = storeToRefs(countStore)\n<\/script>\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Vue \u63d0\u4f9b\u7684 ",(0,s.jsx)(n.code,{children:"toRefs"})," \u4f1a\u5c06 store \u4e2d\u7684\u6570\u636e\u3001\u65b9\u6cd5\u4ee5\u53ca ",(0,s.jsx)(n.code,{children:"_"}),"\u3001",(0,s.jsx)(n.code,{children:"$"})," \u5f00\u5934\u7684\u5c5e\u6027\u5168\u90fd\u8f6c\u6362\u6210 ref \u5bf9\u8c61\uff1b"]}),"\n",(0,s.jsxs)(n.li,{children:["\u800c Pinia \u63d0\u4f9b\u7684 ",(0,s.jsx)(n.code,{children:"storeToRefs"})," \u53ea\u4f1a\u5c06 store \u4e2d\u7684\u6570\u636e\u8f6c\u6362\u6210 ref \u5bf9\u8c61\uff0c\u51cf\u5c11\u4e86\u4e0d\u5fc5\u8981\u5c5e\u6027\u7684\u54cd\u5e94\u6027\u5f00\u9500\u3002"]}),"\n"]})}),"\n",(0,s.jsx)(n.h3,{id:"getters",children:"getters"}),"\n",(0,s.jsxs)(n.p,{children:["\u6982\u5ff5\uff1a\u5f53 ",(0,s.jsx)(n.code,{children:"state"})," \u4e2d\u7684\u6570\u636e\uff0c\u9700\u8981\u7ecf\u8fc7\u5904\u7406\u540e\u518d\u4f7f\u7528\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"getters"})," \u914d\u7f6e\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",metastring:'title="src/store/count.ts"',children:"import { defineStore } from 'pinia';\n\nexport const useCountStore = defineStore('count', {\n  state() {\n    return {\n      sum: 1,\n      school: 'atguigu'\n    };\n  },\n  getters: {\n    // \u63a5\u6536 state \u4f5c\u4e3a\u53c2\u6570\n    bigSum: (state): number => state.sum * 10,\n    // \u5982\u679c\u8981\u7528 this\uff0c\u5c31\u4e0d\u80fd\u5199\u6210\u7bad\u5934\u51fd\u6570\n    upperSchool() {\n      // this \u6307\u5411\u7684\u662f\u5f53\u524d store \u5b9e\u4f8b\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7 this \u8bbf\u95ee state \u4e2d\u7684\u6570\u636e\n      return this.school.toUpperCase();\n    },\n    filterCinemaList(state) {\n      return (value) => {\n        return state.cinemaList.filter(item => item.eTicketFlag === value)\n      }\n    }\n  },\n  actions: {},\n});\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",metastring:'title="\u7ec4\u4ef6\u4e2d\u8bfb\u53d6\u6570\u636e"',children:"import { useCountStore } from '@/store/count'\n\nconst countStore = useCountStore()\nconst { increment, decrement } = countStore\n\nlet { sum, school, bigSum, upperSchool } = storeToRefs(countStore)\n\n// \u8bbf\u95ee getters \u4e2d\u7684\u5c5e\u6027\ncountStore.filterCinemaList(1)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"subscribe",children:"$subscribe"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"store"})," \u7684 ",(0,s.jsx)(n.code,{children:"$subscribe()"})," \u65b9\u6cd5\u7528\u4e8e\u76d1\u542c ",(0,s.jsx)(n.code,{children:"state"})," \u662f\u5426\u53d1\u751f\u53d8\u5316\uff08\u7c7b\u4f3c\u4e8e ",(0,s.jsx)(n.code,{children:"watch"}),"\uff09\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { useTalkStore } from '@/store/talk'\n\nconst talkStore = useTalkStore()\ntalkStore.$subscribe((mutate, state) => {\n  // mutate \u662f\u672c\u6b21\u4fee\u6539\u7684\u4fe1\u606f\uff0cstate \u662f\u4fee\u6539\u540e\u7684\u6570\u636e\n  console.log('LoveTalk', mutate, state)\n  localStorage.setItem('talk', JSON.stringify(state.talkList))\n})\n"})}),"\n",(0,s.jsx)(n.h3,{id:"store-\u7ec4\u5408\u5f0f\u5199\u6cd5",children:"store \u7ec4\u5408\u5f0f\u5199\u6cd5"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { reactive, computed } from 'vue'\nimport axios from 'axios'\nimport { defineStore } from 'pinia'\nimport { nanoid } from 'nanoid'\n\nexport const useTalkStore = defineStore('talk', () => {\n  // talkList \u5c31\u662f state\n  const talkList = reactive(JSON.parse(localStorage.getItem('talkList') as string) || [])\n\n  // \u76f8\u5f53\u4e8e getters\n  const filterCinemaList = computed(() => {\n    return (value) => {\n      return cinemaList.value.filter(item => item.eTicketFlag === value)\n    }\n  })\n\n  // getATalk \u51fd\u6570\u76f8\u5f53\u4e8e action\n  async function getATalk() {\n    let { data: { content: title } } = await axios.get('https://api.uomg.com/api/rand.qinghua?format=json')\n    let obj = { id: nanoid(), title }\n    talkList.unshift(obj)\n  }\n\n  return { talkList, getATalk }\n})\n"})}),"\n",(0,s.jsx)(n.h2,{id:"vuex",children:"Vuex"}),"\n",(0,s.jsx)(n.h3,{id:"\u57fa\u672c\u4f7f\u7528",children:"\u57fa\u672c\u4f7f\u7528"}),"\n",(0,s.jsx)(n.p,{children:"Vuex \u7684\u6570\u636e\u662f\u5b58\u5728\u5185\u5b58\u4e2d\u7684\uff0c\u6240\u4ee5\u5237\u65b0\u9875\u9762\u5c31\u4f1a\u4e22\u5931\u6570\u636e\u72b6\u6001\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",metastring:'title="\u5b89\u88c5"',children:"npm install vuex@next --save\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",metastring:'title="src/store/index.ts"',children:"import { createStore } from 'docs/front-frame/Vue3/vuex'\n\nconst store = createStore({\n  state() {\n    return {\n      isTabBarShow: true,\n      cinemaList: []\n    }\n  },\n  // getter \u76f8\u5f53\u4e8e\u662f store \u7684\u8ba1\u7b97\u5c5e\u6027\n  getters: {\n    filterCinemaList(state) {\n      return value => state.cinemaList.filter(item => item.eTicketFlag === value)\n    }\n  },\n  // Vue Devtool \u4f1a\u76d1\u63a7 mutations\uff0c\u6240\u4ee5\u5efa\u8bae\u5bf9\u6570\u636e\u7684\u64cd\u4f5c\u90fd\u8981\u901a\u8fc7 mutations\n  mutations: {\n    setTabBar(state, payload) {\n      state.isTabBarShow = payload\n    },\n    setCinemaList(state, payload) {\n      state.cinemaList = payload\n    }\n  },\n  actions: {\n    async getCinemaList(context, payload) {\n      console.log(payload)\n      // \u53d1\u9001\u8bf7\u6c42\u83b7\u53d6\u6570\u636e\n      const result = await axios()\n      context.commit('setTabBar', result.data.cinemaList)\n    }\n  }\n})\n\nexport default store\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",metastring:'title="main.js"',children:"import { createApp } from 'vue'\nimport store from './store'\nimport App from './App.vue'\n\ncreateApp(App).use(store).mount('#app')\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",metastring:'title="\u7ec4\u4ef6\u5185\u4f7f\u7528"',children:"import { useStore } from 'vuex'\n\nconst store = useStore()\n\nstore.state.isTabBarShow = false\n\nstore.getters.filterCinemaList(1)\n\nstore.commit('setTabBar', false)\n\nstore.dispatch('getCinemaList', 123)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u8f85\u52a9\u51fd\u6570",children:"\u8f85\u52a9\u51fd\u6570"}),"\n",(0,s.jsxs)(n.p,{children:["Composition API \u4e0d\u652f\u6301 map \u7684\u8f85\u52a9\u51fd\u6570\uff0c\u56e0\u4e3a\u8fd9\u4e9b map \u51fd\u6570\u5185\u90e8\u90fd\u4f7f\u7528\u5230\u4e86 ",(0,s.jsx)(n.code,{children:"this"}),"\u3002"]}),"\n",(0,s.jsxs)(n.p,{children:["\u89e3\u51b3\u65b9\u6848\uff1a\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"bind"}),"\u3002"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { computed } from 'vue'\nimport { useStore, mapState } from 'vuex'\n\nconst state = mapState(['isTabBarShow'])\nconst store = useStore()\nstate.isTabBarShow = state.isTabBarShow.bind({$store: store})\nconst isTabBarShow = computed(state.isTabBarShow)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"module",children:"Module"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { createStore } from 'vuex'\n\nconst moduleA = {\n  namespaced: true,\n  state() {\n    return {\n      xxx: 123\n    }\n  },\n  getters: {},\n  mutations: {\n    setXXX() {}\n  },\n  actions: {}\n}\n\nconst moduleB = {\n  namespaced: true,\n  state() {\n    return {\n      yyy: 'abc'\n    }\n  },\n  getters: {},\n  mutations: {\n    setYYY() {\n    }\n  },\n  actions: {}\n}\n\nconst store = createStore({\n  modules: {\n    moduleA, moduleB\n  }\n})\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { useStore, mapState, mapMutations, mapActions } from 'vuex'\n\nconst store = useStore()\n\nstore.state.moduleA.xxx\nstore.state.moduleB.yyy\n\nconst stateA = mapState('moduleA', ['xxx'])\nconst stateB = mapState('moduleB', ['yyy'])\n\nconst mutationsA = mapMutations('moduleA', ['setXXX'])\nconst mutationsB = mapMutations('moduleB', ['setYYY'])\n\nconst actionsA = mapActions('moduleA', [])\nconst actionsB = mapActions('moduleB', [])\n"})}),"\n",(0,s.jsx)(n.h3,{id:"vuex-\u6301\u4e45\u5316\u63d2\u4ef6",children:"vuex \u6301\u4e45\u5316\u63d2\u4ef6"}),"\n",(0,s.jsx)(n.p,{children:"\u539f\u7406\u4e5f\u662f\u5c06\u6570\u636e\u5b58\u5230 localStorage \u4e2d\u3002"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"npm i vuex-persistedstate\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import createPersistedState from 'vuex-persistedstate'\n\nconst store = createStore({\n  modules: {\n    moduleA, moduleB\n  },\n  plugins: [createPersistedState({\n    reducer: (state) => {\n      return {\n        isTabBarShow: state.moduleA.isTabBarShow\n      }\n    }\n  })]\n})\n"})})]})}function d(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>a,a:()=>i});var s=t(7294);const r={},o=s.createContext(r);function i(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);