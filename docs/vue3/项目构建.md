---
sidebar_position: 2
---

# 项目构建

## 使用 [Vite](https://cn.vitejs.dev/)

```bash
npm create vue@latest

# OR
npm create vite@latest

# OR
yarn create vite
```

## 使用 [Vue CLI](https://cli.vuejs.org/zh/)

```shell title="安装"
npm install -g @vue/cli

# OR
yarn global add @vue/cli
```

```shell title="创建项目"
vue create hello-world
```

## Vite 目录

- `public` 中的资源不会被编译，可以存放静态资源
- `assets` 中的资源会被编译，可以存放可编译的静态资源
- `components` 中用来存放组件
- `App.vue` 是项目根组件
- `main.ts` 是入口文件
- `index.html` 也是入口文件（Webpack、rollup 的入口文件都是 js 文件，而 Vite 的入口文件是一个 html 文件），Vite 刚开始不会编译这些 js 文件，只有当你用到的时候才会发起请求获取并解析相应的文件，如：

  ```html title="index.html"
  <script type="module" src="/src/main.ts"></script>
  ```
  
- `vite.config.ts` 是 Vite 的配置文件

## 单文件组件（SFC）

### template

`.vue` 文件中只能有一个 `<template>` 标签。

`<template>` 中的内容会传递给 `@vue/compiler-dom` 预编译为 JS 的渲染函数（`render`）。

### script

`.vue` 文件中可以有多个 `<script>` 块（不包括 `<script setup>`）。

`<script>` 中的内容将作为 ES Module 来执行，模块默认导出的内容应该是 Vue 组件选项对象，它要么是一个普通的对象，要么是 `defineComponent` 的返回值。

### script setup

`.vue` 文件中最多只能有一个 `<script setup>` 块（不包括常规的 `<script>`）。

`<script setup>` 中的内容会被预处理并作为组件的 `setup()` 函数使用，`<script setup>` 中声明的变量会自动暴露给模板，在模板中可以直接使用。

### style

`.vue` 文件可以有多个 `<style>` 标签。

`<style>` 标签可以通过 scoped 或 module attribute 将样式封装在当前组件内。多个不同封装模式的 `<style>` 标签可以在同一个组件中混用。

## npm run dev 流程

1. 运行 `npm run dev` 时，会先去 package.json 中的 scripts 里面找到 `dev` 命令并执行；

    ![img_1.png](img_1.png)

    那为什么不直接执行 vite 命令呢？因为在我们的电脑上，并没有配置过 vite 的相关命令，所以无法直接执行。

2. `dev` 对应的是 `vite` 命令，于是就会到 `node_modules/` 目录中找到 `vite` 目录（`npm install` 的时候会把 Vite 也装上），读取 `vite` 目录中的 package.json 文件，发现它做了一个软链接（bin）；

    ![img_2.png](img_2.png)

3. 通过软链接，就会到 `node_modules/bin/` 目录中找到对应的脚本文件（`npm install` 的时候会在 `node_modules/.bin/` 目录中创建好脚本文件），然后执行脚本找到相应的 js 文件来执行。

    ![img_3.png](img_3.png)

    查找规则是：
   - 先从当前项目的 `node_modules/bin` 中找；
   - 找不到去全局的 `node_module/bin` 中找；
   - 再找不到就去环境变量中找，如果还找不到就会报错。

    `node_modules/bin` 目录中有三个 vite 文件，为什么会有三个文件呢？

    ```shell
    # unix Linux macOS 系统默认的可执行文件
    vite
  
    # windows cmd 中默认的可执行文件
    vite.cmd
  
    # Windows PowerShell 中可执行文件
    vite.ps1
    ```
