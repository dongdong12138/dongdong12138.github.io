---
sidebar_position: 9
---

# 生命周期

import Tabs from '@theme/Tabs'
import TabItem from '@theme/TabItem'
import Vue2Lifecycle from './images/img_8.png'
import Vue3Lifecycle from './images/img_9.svg'

<Tabs>
  <TabItem value="vue2" label="Vue2 生命周期图示" default>
    <img src={Vue2Lifecycle} alt="Vue2Lifecycle" />
  </TabItem>
  <TabItem value="vue3" label="Vue3 生命周期图示">
    <Vue3Lifecycle />
  </TabItem>
</Tabs>

Vue3 中可以继续使用 Vue2 中的生命周期钩子，但有两个被更名：
- `beforeDestroy` 改名为 `beforeUnmount`
- `destroyed` 改名为 `unmounted`

Vue3 也提供了 Composition API 形式的生命周期钩子，与 Vue2 中钩子对应关系如下：
- `beforeCreate` => `setup`
- `created` => `setup`
- `beforeMount` => `onBeforeMount`
- `mounted` => `onMounted`
- `beforeUpdate` => `onBeforeUpdate`
- `updated` => `onUpdated`
- `beforeUnmount` => `onBeforeUnmount`
- `unmounted` => `onUnmounted`

无论是哪种生命周期钩子，`setup` 都是最先执行的。

配置项形式的钩子与 `setup` 中的钩子，同一时机的钩子，都会执行，但优先执行 `setup` 中的。

```js title="Vue3 的生命周期钩子"
import { onBeforeMount, onMounted, onBeforeUpdate, onUpdated, onBeforeUnmount, onUnmounted } from 'vue'

export default {
  name: '',
  // setup 最先执行
  setup() {
    // 写在 setup 中的生命周期钩子
    onBeforeMount(() => {
      console.log('onBeforeMount')
    })
    onMounted(() => {
      console.log('onMounted')
    })
    onBeforeUpdate(() => {
      console.log('onBeforeUpdate')
    })
    onUpdated(() => {
      console.log('onUpdated')
    })
    onBeforeUnmount(() => {
      console.log('onBeforeUnmount')
    })
    onUnmounted(() => {
      console.log('onUnmounted')
    })
  },
  // 通过配置项写的生命周期钩子
  beforeCreate() {},
  created() {},
  beforeMount() {},
  mounted() {},
  beforeUpdate() {},
  updated() {},
  beforeUnmount() {},
  unmounted() {}
}
```

`updated` 钩子存在的问题：这个钩子会在组件的任意 DOM 更新后被调用，这些更新可能是由不同的状态变更导致的。如果你需要在某个特定的状态更改后访问更新后的 DOM，请使用 `nextTick()` 作为替代。
